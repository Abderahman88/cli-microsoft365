



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Authorization and access tokens - Office 365 CLI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#authorization-and-access-tokens" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Office 365 CLI" class="md-header-nav__button md-logo">
          
            <img src="../../images/office.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Office 365 CLI
              </span>
              <span class="md-header-nav__topic">
                Authorization and access tokens
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="http://github.com/SharePoint/office365-cli/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/installing-cli/" title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../cmd/spo/connect/" title="Commands" class="md-tabs__link">
          Commands
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../persisting-connection/" title="Concepts" class="md-tabs__link md-tabs__link--active">
          Concepts
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/why-cli/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/office.png" width="24" height="24">
      
    </span>
    Office 365 CLI
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="http://github.com/SharePoint/office365-cli/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/installing-cli/" title="Installing the CLI" class="md-nav__link">
      Installing the CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/using-cli/" title="Using the CLI" class="md-nav__link">
      Using the CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/connecting-office-365/" title="Connecting to Office 365" class="md-nav__link">
      Connecting to Office 365
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cli-output-mode/" title="CLI output mode" class="md-nav__link">
      CLI output mode
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Commands
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Commands
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      SharePoint Online (spo)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        SharePoint Online (spo)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/connect/" title="connect" class="md-nav__link">
      connect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/disconnect/" title="disconnect" class="md-nav__link">
      disconnect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/status/" title="status" class="md-nav__link">
      status
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-4" type="checkbox" id="nav-3-1-4">
    
    <label class="md-nav__link" for="nav-3-1-4">
      app
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-4">
        app
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-add/" title="app add" class="md-nav__link">
      app add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-deploy/" title="app deploy" class="md-nav__link">
      app deploy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-get/" title="app get" class="md-nav__link">
      app get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-install/" title="app install" class="md-nav__link">
      app install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-list/" title="app list" class="md-nav__link">
      app list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-remove/" title="app remove" class="md-nav__link">
      app remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-retract/" title="app retract" class="md-nav__link">
      app retract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-uninstall/" title="app uninstall" class="md-nav__link">
      app uninstall
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/app/app-upgrade/" title="app upgrade" class="md-nav__link">
      app upgrade
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-5" type="checkbox" id="nav-3-1-5">
    
    <label class="md-nav__link" for="nav-3-1-5">
      cdn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-5">
        cdn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-get/" title="cdn get" class="md-nav__link">
      cdn get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-origin-add/" title="cdn origin add" class="md-nav__link">
      cdn origin add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-origin-list/" title="cdn origin list" class="md-nav__link">
      cdn origin list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-origin-remove/" title="cdn origin remove" class="md-nav__link">
      cdn origin remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-policy-list/" title="cdn policy list" class="md-nav__link">
      cdn policy list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-policy-set/" title="cdn policy set" class="md-nav__link">
      cdn policy set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/cdn/cdn-set/" title="cdn set" class="md-nav__link">
      cdn set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-6" type="checkbox" id="nav-3-1-6">
    
    <label class="md-nav__link" for="nav-3-1-6">
      customaction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-6">
        customaction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/customaction/customaction-add/" title="customaction add" class="md-nav__link">
      customaction add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/customaction/customaction-clear/" title="customaction clear" class="md-nav__link">
      customaction clear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/customaction/customaction-get/" title="customaction get" class="md-nav__link">
      customaction get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/customaction/customaction-list/" title="customaction list" class="md-nav__link">
      customaction list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/customaction/customaction-remove/" title="customaction remove" class="md-nav__link">
      customaction remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/customaction/customaction-set/" title="customaction set" class="md-nav__link">
      customaction set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-7" type="checkbox" id="nav-3-1-7">
    
    <label class="md-nav__link" for="nav-3-1-7">
      externaluser
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-7">
        externaluser
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/externaluser/externaluser-list/" title="externaluser list" class="md-nav__link">
      externaluser list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-8" type="checkbox" id="nav-3-1-8">
    
    <label class="md-nav__link" for="nav-3-1-8">
      file
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-8">
        file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/file/file-list/" title="file list" class="md-nav__link">
      file list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-9" type="checkbox" id="nav-3-1-9">
    
    <label class="md-nav__link" for="nav-3-1-9">
      hubsite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-9">
        hubsite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-connect/" title="hubsite connect" class="md-nav__link">
      hubsite connect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-disconnect/" title="hubsite disconnect" class="md-nav__link">
      hubsite disconnect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-get/" title="hubsite get" class="md-nav__link">
      hubsite get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-list/" title="hubsite list" class="md-nav__link">
      hubsite list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-register/" title="hubsite register" class="md-nav__link">
      hubsite register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-rights-grant/" title="hubsite rights grant" class="md-nav__link">
      hubsite rights grant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-rights-revoke/" title="hubsite rights revoke" class="md-nav__link">
      hubsite rights revoke
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-set/" title="hubsite set" class="md-nav__link">
      hubsite set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/hubsite/hubsite-unregister/" title="hubsite unregister" class="md-nav__link">
      hubsite unregister
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-10" type="checkbox" id="nav-3-1-10">
    
    <label class="md-nav__link" for="nav-3-1-10">
      list
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-10">
        list
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/list/list-add/" title="list add" class="md-nav__link">
      list add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/list/list-get/" title="list get" class="md-nav__link">
      list get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/list/list-list/" title="list list" class="md-nav__link">
      list list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/list/list-remove/" title="list remove" class="md-nav__link">
      list remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/list/list-set/" title="list set" class="md-nav__link">
      list set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-11" type="checkbox" id="nav-3-1-11">
    
    <label class="md-nav__link" for="nav-3-1-11">
      propertybag
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-11">
        propertybag
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/propertybag/propertybag-get/" title="propertybag get" class="md-nav__link">
      propertybag get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/propertybag/propertybag-list/" title="propertybag list" class="md-nav__link">
      propertybag list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-12" type="checkbox" id="nav-3-1-12">
    
    <label class="md-nav__link" for="nav-3-1-12">
      serviceprincipal
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-12">
        serviceprincipal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/serviceprincipal/serviceprincipal-grant-list/" title="serviceprincipal grant list" class="md-nav__link">
      serviceprincipal grant list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/serviceprincipal/serviceprincipal-grant-revoke/" title="serviceprincipal grant revoke" class="md-nav__link">
      serviceprincipal grant revoke
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/serviceprincipal/serviceprincipal-permissionrequest-approve/" title="serviceprincipal permissionrequest approve" class="md-nav__link">
      serviceprincipal permissionrequest approve
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/serviceprincipal/serviceprincipal-permissionrequest-deny/" title="serviceprincipal permissionrequest deny" class="md-nav__link">
      serviceprincipal permissionrequest deny
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/serviceprincipal/serviceprincipal-permissionrequest-list/" title="serviceprincipal permissionrequest list" class="md-nav__link">
      serviceprincipal permissionrequest list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/serviceprincipal/serviceprincipal-set/" title="serviceprincipal set" class="md-nav__link">
      serviceprincipal set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-13" type="checkbox" id="nav-3-1-13">
    
    <label class="md-nav__link" for="nav-3-1-13">
      site
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-13">
        site
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-add/" title="site add" class="md-nav__link">
      site add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-get/" title="site get" class="md-nav__link">
      site get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-list/" title="site list" class="md-nav__link">
      site list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-set/" title="site set" class="md-nav__link">
      site set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-appcatalog-add/" title="site appcatalog add" class="md-nav__link">
      site appcatalog add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-appcatalog-remove/" title="site appcatalog remove" class="md-nav__link">
      site appcatalog remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-classic-add/" title="site classic add" class="md-nav__link">
      site classic add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-classic-list/" title="site classic list" class="md-nav__link">
      site classic list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/site/site-classic-set/" title="site classic set" class="md-nav__link">
      site classic set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-14" type="checkbox" id="nav-3-1-14">
    
    <label class="md-nav__link" for="nav-3-1-14">
      sitedesign
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-14">
        sitedesign
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-add/" title="sitedesign add" class="md-nav__link">
      sitedesign add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-get/" title="sitedesign get" class="md-nav__link">
      sitedesign get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-list/" title="sitedesign list" class="md-nav__link">
      sitedesign list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-remove/" title="sitedesign remove" class="md-nav__link">
      sitedesign remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-set/" title="sitedesign set" class="md-nav__link">
      sitedesign set
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-rights-grant/" title="sitedesign rights grant" class="md-nav__link">
      sitedesign rights grant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-rights-list/" title="sitedesign rights list" class="md-nav__link">
      sitedesign rights list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitedesign/sitedesign-rights-revoke/" title="sitedesign rights revoke" class="md-nav__link">
      sitedesign rights revoke
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-15" type="checkbox" id="nav-3-1-15">
    
    <label class="md-nav__link" for="nav-3-1-15">
      sitescript
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-15">
        sitescript
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitescript/sitescript-add/" title="sitescript add" class="md-nav__link">
      sitescript add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitescript/sitescript-get/" title="sitescript get" class="md-nav__link">
      sitescript get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitescript/sitescript-list/" title="sitescript list" class="md-nav__link">
      sitescript list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitescript/sitescript-remove/" title="sitescript remove" class="md-nav__link">
      sitescript remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/sitescript/sitescript-set/" title="sitescript set" class="md-nav__link">
      sitescript set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-16" type="checkbox" id="nav-3-1-16">
    
    <label class="md-nav__link" for="nav-3-1-16">
      storageentity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-16">
        storageentity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/storageentity/storageentity-get/" title="storageentity get" class="md-nav__link">
      storageentity get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/storageentity/storageentity-list/" title="storageentity list" class="md-nav__link">
      storageentity list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/storageentity/storageentity-remove/" title="storageentity remove" class="md-nav__link">
      storageentity remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/storageentity/storageentity-set/" title="storageentity set" class="md-nav__link">
      storageentity set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-17" type="checkbox" id="nav-3-1-17">
    
    <label class="md-nav__link" for="nav-3-1-17">
      tenant
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-17">
        tenant
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/tenant/tenant-appcatalogurl-get/" title="tenant appcatalogurl get" class="md-nav__link">
      tenant appcatalogurl get
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-18" type="checkbox" id="nav-3-1-18">
    
    <label class="md-nav__link" for="nav-3-1-18">
      web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-18">
        web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/web/web-add/" title="web add" class="md-nav__link">
      web add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/web/web-list/" title="web list" class="md-nav__link">
      web list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/spo/web/web-remove/" title="web remove" class="md-nav__link">
      web remove
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Microsoft Graph (graph)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Microsoft Graph (graph)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/connect/" title="connect" class="md-nav__link">
      connect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/disconnect/" title="disconnect" class="md-nav__link">
      disconnect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/status/" title="status" class="md-nav__link">
      status
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-4" type="checkbox" id="nav-3-2-4">
    
    <label class="md-nav__link" for="nav-3-2-4">
      o365group
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-4">
        o365group
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/o365group/o365group-add/" title="o365group add" class="md-nav__link">
      o365group add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/o365group/o365group-get/" title="o365group get" class="md-nav__link">
      o365group get
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/o365group/o365group-list/" title="o365group list" class="md-nav__link">
      o365group list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/graph/o365group/o365group-set/" title="o365group set" class="md-nav__link">
      o365group set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Azure Active Directory Graph (aad)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Azure Active Directory Graph (aad)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/connect/" title="connect" class="md-nav__link">
      connect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/disconnect/" title="disconnect" class="md-nav__link">
      disconnect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/status/" title="status" class="md-nav__link">
      status
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-4" type="checkbox" id="nav-3-3-4">
    
    <label class="md-nav__link" for="nav-3-3-4">
      oauth2grant
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-4">
        oauth2grant
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/oauth2grant/oauth2grant-add/" title="oauth2grant add" class="md-nav__link">
      oauth2grant add
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/oauth2grant/oauth2grant-list/" title="oauth2grant list" class="md-nav__link">
      oauth2grant list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/oauth2grant/oauth2grant-remove/" title="oauth2grant remove" class="md-nav__link">
      oauth2grant remove
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/oauth2grant/oauth2grant-set/" title="oauth2grant set" class="md-nav__link">
      oauth2grant set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-5" type="checkbox" id="nav-3-3-5">
    
    <label class="md-nav__link" for="nav-3-3-5">
      service principal (sp)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-5">
        service principal (sp)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmd/aad/sp/sp-get/" title="sp get" class="md-nav__link">
      sp get
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Concepts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Concepts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../persisting-connection/" title="Persisting connection" class="md-nav__link">
      Persisting connection
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Authorization and access tokens
      </label>
    
    <a href="./" title="Authorization and access tokens" class="md-nav__link md-nav__link--active">
      Authorization and access tokens
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tldr" title="TL;DR" class="md-nav__link">
    TL;DR
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-in-the-office-365-cli" title="Authorization in the Office 365 CLI" class="md-nav__link">
    Authorization in the Office 365 CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure-ad-application-used-by-the-office-365-cli" title="Azure AD application used by the Office 365 CLI" class="md-nav__link">
    Azure AD application used by the Office 365 CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-and-refresh-tokens-in-the-office-365-cli" title="Access and refresh tokens in the Office 365 CLI" class="md-nav__link">
    Access and refresh tokens in the Office 365 CLI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services-and-commands" title="Services and commands" class="md-nav__link">
    Services and commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#communicating-with-office-365" title="Communicating with Office 365" class="md-nav__link">
    Communicating with Office 365
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#refresh-access-token-for-the-current-resource" title="Refresh access token for the current resource" class="md-nav__link">
    Refresh access token for the current resource
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtain-a-valid-access-token-for-a-different-resource" title="Obtain a valid access token for a different resource" class="md-nav__link">
    Obtain a valid access token for a different resource
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-two-different-methods-to-get-tokens" title="Why two different methods to get tokens" class="md-nav__link">
    Why two different methods to get tokens
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-of-thumb" title="Rules of thumb" class="md-nav__link">
    Rules of thumb
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../completion/" title="Command completion" class="md-nav__link">
      Command completion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../communicating-o365/" title="Communication with Office 365" class="md-nav__link">
      Communication with Office 365
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/why-cli/" title="Why this CLI" class="md-nav__link">
      Why this CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/comparison-powershell/" title="Comparison to SharePoint PowerShell" class="md-nav__link">
      Comparison to SharePoint PowerShell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tldr" title="TL;DR" class="md-nav__link">
    TL;DR
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-in-the-office-365-cli" title="Authorization in the Office 365 CLI" class="md-nav__link">
    Authorization in the Office 365 CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure-ad-application-used-by-the-office-365-cli" title="Azure AD application used by the Office 365 CLI" class="md-nav__link">
    Azure AD application used by the Office 365 CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-and-refresh-tokens-in-the-office-365-cli" title="Access and refresh tokens in the Office 365 CLI" class="md-nav__link">
    Access and refresh tokens in the Office 365 CLI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services-and-commands" title="Services and commands" class="md-nav__link">
    Services and commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#communicating-with-office-365" title="Communicating with Office 365" class="md-nav__link">
    Communicating with Office 365
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#refresh-access-token-for-the-current-resource" title="Refresh access token for the current resource" class="md-nav__link">
    Refresh access token for the current resource
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtain-a-valid-access-token-for-a-different-resource" title="Obtain a valid access token for a different resource" class="md-nav__link">
    Obtain a valid access token for a different resource
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-two-different-methods-to-get-tokens" title="Why two different methods to get tokens" class="md-nav__link">
    Why two different methods to get tokens
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-of-thumb" title="Rules of thumb" class="md-nav__link">
    Rules of thumb
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="http://github.com/SharePoint/office365-cli/blob/master/docs/manual/docs/concepts/authorization-tokens.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="authorization-and-access-tokens">Authorization and access tokens<a class="headerlink" href="#authorization-and-access-tokens" title="Permanent link">&para;</a></h1>
<p>Commands provided with the Office 365 CLI manipulate different settings of Office 365. Before you can execute any of the commands in the CLI, you have to connect to the Office 365 service corresponding to your command, such as SharePoint or Microsoft Graph.</p>
<h2 id="tldr">TL;DR<a class="headerlink" href="#tldr" title="Permanent link">&para;</a></h2>
<p>Use <code>Auth.ensureAccessToken</code> when:</p>
<ul>
<li>the URL of the service to which you are connected and the URL of the API you're communicating with are the same, eg. you're connected to AAD Graph at <code>https://graph.windows.net</code> and you're calling <code>https://graph.windows.net/myorganization/servicePrincipals</code> or you're connected to SharePoint tenant admin site at <code>https://contoso-admin.sharepoint.com</code> and you're calling the tenant admin API at <code>https://contoso-admin.sharepoint.com/_vti_bin/client.svc/ProcessQuery</code></li>
<li>you want to renew the refresh token persisted in the Office 365 CLI</li>
</ul>
<p>Use <code>Auth.getAccessToken</code> when:</p>
<ul>
<li>the URL of the service to which you are connected and the URL of the API you're calling are different, eg. you're connected to a SharePoint Online tenant admin site at <code>https://contoso-admin.sharepoint.com</code>, but you're calling <code>https://contoso.sharepoint.com/sites/team/_api/web/tenantappcatalog/AvailableApps/GetById('cd807889-9107-416e-88e4-7575789ab35c')/install</code> to install an app on a regular SharePoint site</li>
<li>you're obtaining access token for a service different than the one to which you are connected and don't want to break the existing connection</li>
</ul>
<h2 id="authorization-in-the-office-365-cli">Authorization in the Office 365 CLI<a class="headerlink" href="#authorization-in-the-office-365-cli" title="Permanent link">&para;</a></h2>
<p>There are a number of ways in which you can authenticate and authorize with Office 365. The Office 365 CLI uses the OAuth protocol to authorize with Office 365 and its services. OAuth flows in Office 365 are facilitated by Azure Active Directory.</p>
<h3 id="azure-ad-application-used-by-the-office-365-cli">Azure AD application used by the Office 365 CLI<a class="headerlink" href="#azure-ad-application-used-by-the-office-365-cli" title="Permanent link">&para;</a></h3>
<p>Office 365 CLI gets access to Office 365 through a custom Azure AD application named <em>PnP Office 365 Management Shell</em>. If you don't want to consent this application in your tenant, you can use a different application instead.</p>
<p>When specifying a custom Azure AD application to be used by the Office 365 CLI, you can either choose to use one application for all Office 365 services or a separate application for each service. To use one Azure AD application for all Office 365 CLI commands, set the <code>OFFICE365CLI_AADAPPID</code> environment variable to the ID of your Azure AD application. If you want to use a different Azure AD application for each Office 365 service use the following environment variables:</p>
<ul>
<li><code>OFFICE365CLI_AADAADAPPID</code> - for the ID of the Azure AD application to communicate with Azure AD Graph</li>
<li><code>OFFICE365CLI_AADGRAPHAPPID</code> - for the ID of the Azure AD application to communicate with the Microsoft Graph</li>
<li><code>OFFICE365CLI_AADSPOAPPID</code> - for the ID of the Azure AD application to communicate with SharePoint Online</li>
</ul>
<p>Office 365 CLI requires the following permissions to Office 365 services:</p>
<ul>
<li>Office 365 SharePoint Online (Microsoft.SharePoint)<ul>
<li>Have full control of all site collections</li>
<li>Read user profiles</li>
<li>Read and write managed metadata</li>
</ul>
</li>
<li>Microsoft Graph<ul>
<li>Invite guest users to the organization</li>
<li>Read and write all groups</li>
<li>Read and write directory data</li>
<li>Access directory as the signed in user</li>
<li>Read and write identity providers</li>
</ul>
</li>
<li>Windows Azure Active Directory<ul>
<li>Access the directory as the signed-in user</li>
</ul>
</li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>After changing the ID of the Azure AD application used by the Office 365 CLI refresh the existing connections to Office 365 using the corresponding <code>&lt;service&gt; connect</code> command. If you try to use the existing connection, Office 365 CLI will fail when trying to refresh the existing access token.</p>
</div>
<h3 id="access-and-refresh-tokens-in-the-office-365-cli">Access and refresh tokens in the Office 365 CLI<a class="headerlink" href="#access-and-refresh-tokens-in-the-office-365-cli" title="Permanent link">&para;</a></h3>
<p>After completing the OAuth flow, the CLI receives from Azure Active Directory a refresh- and an access token. Each web request to Office 365 APIs contains the access token which authorizes the Office 365 CLI to execute the particular operation. When the access token expires, the CLI uses the refresh token to obtain a new access token. When the refresh token expires, the user has to reconnect to Office 365 to obtain a new refresh token.</p>
<h2 id="services-and-commands">Services and commands<a class="headerlink" href="#services-and-commands" title="Permanent link">&para;</a></h2>
<p>Each command in the Office 365 CLI belongs to a service, for example the <a href="../../cmd/spo/site/site-add/">spo site add</a> command, which creates a new modern site, belongs to the SharePoint Online service, while the <a href="../../cmd/aad/sp/sp-get/">aad sp get</a> command, which lists Azure Active Directory service principals, belongs to the Azure Active Directory Graph service. Each service in Office 365 is a different Azure Active Directory authorization resource and requires a separate access token. When working with the CLI, you can be simultaneously connected to multiple services. Each command in the CLI knows which Office 365 service it communicates with and for which resource it should have a valid access token.</p>
<h2 id="communicating-with-office-365">Communicating with Office 365<a class="headerlink" href="#communicating-with-office-365" title="Permanent link">&para;</a></h2>
<p>Before a command can connect to Office 365, it requires a valid access token. Office 365 CLI offers you two methods to obtain a valid access token: <a href="https://github.com/SharePoint/office365-cli/blob/8b4ede874923fbe5fd84ebe79dc20206da18a529/src/Auth.ts#L62-L214">Auth.ensureAccessToken</a> and <a href="https://github.com/SharePoint/office365-cli/blob/8b4ede874923fbe5fd84ebe79dc20206da18a529/src/Auth.ts#L216-L255">Auth.getAccessToken</a>. While the methods seem similar, they work differently and are meant for different purposes.</p>
<h3 id="refresh-access-token-for-the-current-resource">Refresh access token for the current resource<a class="headerlink" href="#refresh-access-token-for-the-current-resource" title="Permanent link">&para;</a></h3>
<p>If you're building a command that operates on the same URL, as the service to which the user is connected, you should use the <code>Auth.ensureAccessToken</code> method to refresh the token. Not only does this method resolve to a valid access token, which you can use directly in your code, but also stores the new access- and refresh token in the <code>auth.service</code> object from which you can use in any point in code.</p>
<p>For example: you're building a command that retrieves the list of service principals from the Azure Active Directory (<a href="../../cmd/aad/sp/sp-get/">aad sp get</a>). The command uses the Azure Active Directory Graph API (<code>https://graph.windows.net</code>) for this. Since the resource URL of the AAD Graph service (<code>https://graph.windows.net</code>) and the URL of the API that the command has to call (<code>https://graph.windows.net/myorganization/servicePrincipals</code>) are both located on the same domain <code>https://graph.windows.net</code>, you should call the <code>Auth.ensureAccessToken</code> method to obtain a valid access token for the AAD Graph service, before calling the API.</p>
<p>As another example, let's take a method that communicates with the SharePoint Online tenant admin API to set a tenant property (<a href="../../cmd/spo/storageentity/storageentity-set/">spo storageentity set</a>). While using the <a href="../../cmd/spo/connect/">spo connect</a> command, users can connect to any SharePoint site, the <em>spo storageentity set</em> command requires the user to be connected to the SharePoint tenant admin site. As a result, both the URL of the service, to which the user is connected (<code>https://contoso-admin.sharepoint.com</code>) and the URL of the API used by the service (<code>https://contoso-admin.sharepoint.com/_vti_bin/client.svc/ProcessQuery</code>) are located on the same domain <code>https://contoso-admin.sharepoint.com</code>, which is why you should call the <code>Auth.ensureAccessToken</code> method to obtain a valid access for the SharePoint Online tenant admin site, before calling the API.</p>
<h3 id="obtain-a-valid-access-token-for-a-different-resource">Obtain a valid access token for a different resource<a class="headerlink" href="#obtain-a-valid-access-token-for-a-different-resource" title="Permanent link">&para;</a></h3>
<p>In some cases, while the user is connected to one service (with a corresponding resource), you need to retrieve a valid access token for a different resource. This is often the case when building SharePoint commands. In Office 365, SharePoint resources are spread over the following different domains: <code>contoso-admin.sharepoint.com</code> - which hosts the SharePoint Online tenant admin site, <code>contoso.sharepoint.com</code> - which hosts regular SharePoint sites and <code>contoso-my.sharepoint.com</code> - which hosts users' OneDrive sites. From Azure Active Directory point of view, all these domains are perceived as separate resources and require different access tokens.</p>
<p>If you're building a command that allows users to specify a URL on which the operation should be performed, such as <a href="../../cmd/spo/app/app-install/">spo app install</a>, you cannot make any assumptions of the service to which they're connected, and you should obtain a valid access token for the resources corresponding to the URL specified by the user, using the <code>Auth.getResourceToken</code> method. While the <code>Auth.getResourceToken</code> method also returns a valid access token for the specified resource, it doesn't update the connection information on the <code>auth.service</code> object.</p>
<h2 id="why-two-different-methods-to-get-tokens">Why two different methods to get tokens<a class="headerlink" href="#why-two-different-methods-to-get-tokens" title="Permanent link">&para;</a></h2>
<p>In the Office 365 CLI, connecting to Office 365 services is interactive and requires user input. If commands relied on context information from the site, to which users are connected, it would be impossible to build scripts using the Office 365 CLI commands.</p>
<p>Some SharePoint commands require to be executed in the context of the tenant admin site. Some commands additionally require specifying tenant information. For performance reasons, this information is retrieved only initially, when connecting to SharePoint, if the specified site to connect to is a tenant admin site. Because tenant information doesn't change, there is no point in retrieving it on every call to SharePoint. If users would first connect to a regular SharePoint site, and would then switch to the tenant admin site, the tenant information would be missing and the commands requiring it would fail.</p>
<h2 id="rules-of-thumb">Rules of thumb<a class="headerlink" href="#rules-of-thumb" title="Permanent link">&para;</a></h2>
<ul>
<li>if you're building a command for a service other than SharePoint Online, you will most likely use the <code>Auth.ensureAccessToken</code> method</li>
<li>if the command you're building allows the user to specify a URL on which the API is called, you should use the <code>Auth.getAccessToken</code> method to get access token for the URL specified by the user</li>
</ul>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../persisting-connection/" title="Persisting connection" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Persisting connection
              </span>
            </div>
          </a>
        
        
          <a href="../completion/" title="Command completion" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Command completion
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://twitter.com/officedevpnp" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://aka.ms/sppnp-videos" class="md-footer-social__link fa fa-youtube"></a>
    
      <a href="https://aka.ms/sppnp" class="md-footer-social__link fa fa-link"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-110480857-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>